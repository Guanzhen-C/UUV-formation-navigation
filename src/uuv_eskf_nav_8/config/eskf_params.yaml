# ESKF水下导航系统配置文件 - 高精度纯惯导优化版
# 基于误差状态卡尔曼滤波的水下载具导航参数
# 
# 关键修正：
# 1. **精确匹配URDF传感器规格** - 陀螺仪从0.01→4.1e-6 rad/s，加速度计从0.02→1.4e-4 m/s²
# 2. **充分利用导航级IMU精度** - 0.001°/h陀螺零偏，10μg/√Hz加速度计噪声
# 3. **修正4-5个数量级的参数错配** - 之前算法严重低估了传感器精度
# 4. DVL和航向测量已禁用，测试真正的导航级纯惯导性能

# ================================
# 机器人相关参数
# ================================
robot_name: "eca_a9_8"
world_frame: "odom"         # 世界坐标系名称  
base_link_frame: "eca_a9_8/base_link"  # 机器人基座坐标系名称

# ================================
# IMU噪声模型参数
# ================================
imu:
  # 陀螺仪测量噪声标准差 [rad/s] - 精确匹配URDF中的导航级IMU
  # URDF: gyroscope_noise_density="0.00000029088" (0.29 μrad/s/√Hz)
  # 转换为离散噪声: σ = noise_density * √(sample_rate) = 0.29e-6 * √200 ≈ 4.1e-6
  gyro_noise_std: 4.1e-6                # 真正的导航级IMU精度
  
  # 加速度计测量噪声标准差 [m/s²] - 精确匹配URDF中的导航级IMU
  # URDF: accelerometer_noise_density="0.000010" (10 μg/√Hz)
  # 转换为离散噪声: σ = 10e-6 * √200 ≈ 1.4e-4 m/s²
  accel_noise_std: 1.4e-4               # 真正的导航级IMU精度
  
  # 陀螺仪偏差随机游走标准差 [rad/s] - 匹配0.001°/h稳定性
  # URDF: gyroscope_turn_on_bias_sigma="0.000004848" (0.001°/h)
  # 随机游走: bias_walk = bias_sigma / √(correlation_time)
  gyro_bias_std: 8.1e-8                 # 对应3600s相关时间
  
  # 加速度计偏差随机游走标准差 [m/s²] - 匹配mg级稳定性  
  # URDF: accelerometer_turn_on_bias_sigma="0.0098" (1mg)
  # 随机游走: bias_walk = bias_sigma / √(correlation_time)
  accel_bias_std: 1.6e-4                # 对应3600s相关时间

# ================================
# DVL(多普勒测速仪)参数
# ================================
dvl:
  # DVL速度测量噪声标准差 [m/s]
  # 直接影响速度观测的权重，值越小越信任DVL测量
  noise_std: 1.33333

# ================================  
# 深度传感器参数
# ================================
depth:
  # 深度测量噪声标准差 [m]
  # 直接影响深度观测的权重，值越小越信任深度测量
  noise_std: 0.05

# ================================
# 航向量测（可选）
# ================================
heading:
  # 航向角噪声标准差 [rad]（来自IMU姿态或罗盘）
  noise_std: 50000 #0.05

# ================================
# 初始状态设置
# ================================
initial_state:
  # 初始位置 [纬度, 经度, 高度] 单位: [弧度, 弧度, 米]
  # 三亚坐标: 18.25°N, 109.5°E, 海面0米
  position: [0.3183, 1.9111, 0.0]
  
  # 初始速度 [vx, vy, vz] 单位: 米/秒
  # 载具初始时刻的运动速度
  velocity: [0.0, 0.0, 0.0]
  
  # 初始姿态 [roll, pitch, yaw] 单位: 弧度
  # 载具初始时刻的姿态角，遵循ZYX欧拉角顺序
  attitude: [0.0, 0.0, 0.0]

# ================================
# 初始不确定性(协方差对角元素的标准差)
# ================================ 
# 注意：这些值的平方将作为初始协方差矩阵的对角元素
initial_covariance_diagonal:
  # 位置不确定性标准差 [m] - 高精度IMU优化
  # 更精确的初始位置估计，提升纯惯导起始性能
  - 0.01    # x位置标准差 (高精度初始化)
  - 0.01    # y位置标准差 (高精度初始化)
  - 0.005   # z位置标准差 (深度方向精度更高)
  
  # 速度不确定性标准差 [m/s] - 高精度IMU优化
  # 更精确的初始速度估计，减少积分误差累积
  - 0.001   # x速度标准差 (高精度IMU支持)
  - 0.001   # y速度标准差 (高精度IMU支持)
  - 0.001   # z速度标准差 (高精度IMU支持)
  
  # 姿态不确定性标准差 [rad] - 高精度IMU优化
  # 高精度IMU支持更准确的初始姿态估计
  - 0.0017  # roll标准差 (~1°, 高精度IMU)
  - 0.0017  # pitch标准差 (~1°, 高精度IMU)  
  - 0.0035  # yaw标准差 (~2°, 航向相对不确定)
  
  # 陀螺仪偏差不确定性标准差 [rad/s] - 基于导航级IMU真实规格
  # URDF: gyroscope_turn_on_bias_sigma="0.000004848" (0.001°/h)
  # 使用接近URDF规格的值，略微放宽以考虑初始化不确定性
  - 1.0e-5  # x轴陀螺偏差标准差 (导航级精度, ~2倍URDF规格)
  - 1.0e-5  # y轴陀螺偏差标准差 (导航级精度, ~2倍URDF规格) 
  - 1.0e-5  # z轴陀螺偏差标准差 (导航级精度, ~2倍URDF规格)
  
  # 加速度计偏差不确定性标准差 [m/s²] - 基于导航级IMU真实规格
  # URDF: accelerometer_turn_on_bias_sigma="0.0098" (1mg)
  # 使用接近URDF规格的值，略微放宽以考虑初始化不确定性
  - 0.002    # x轴加速度计偏差标准差 (导航级精度, ~2倍URDF规格)
  - 0.002    # y轴加速度计偏差标准差 (导航级精度, ~2倍URDF规格)
  - 0.002    # z轴加速度计偏差标准差 (导航级精度, ~2倍URDF规格)

# ================================
# ESKF算法参数
# ================================
algorithm_params:
  # 启用地球自转补偿（长时间导航必需）
  enable_earth_rotation: true
  
  # 任务区域纬度 [度] - 三亚海域
  mission_latitude_deg: 18.25
  
  # 启用圆锥误差补偿
  enable_coning_correction: true
  
  # 启用划桨效应补偿  
  enable_sculling_correction: true

# ================================
# 系统行为参数
# ================================
# 是否发布TF变换
publish_tf: true

# 最大初始化等待时间 [秒]
# 如果超过此时间还未收到所有传感器数据，则报告初始化失败
max_initialization_time: 10.0

# ================================
# 调试和监控参数  
# ================================
debug:
  # 是否打印详细的调试信息
  verbose: false
  
  # 状态监控频率 [Hz]
  # 控制导航状态信息的打印频率
  status_report_frequency: 0.1
